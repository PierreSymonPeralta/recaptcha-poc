<html>
  <head>
    <title>Recaptcha test app</title>
    <meta name="title" content="test recaptcha">
    <meta name="description" content="test recaptcha desc">
    <script src="https://www.google.com/recaptcha/api.js?render=6LfgF-kUAAAAAE1EJ-BxXm1On5xgLaVv83IZkA08"></script>
    <style>
      body {
        font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }
    </style>
  </head>
  <body>
      <h3>Invisible recaptcha</h3>
    
    <script>

      window.addEventListener('load', () => {
      
        grecaptcha.ready(function() {
          grecaptcha.execute('6LfgF-kUAAAAAE1EJ-BxXm1On5xgLaVv83IZkA08', {action: 'homepage'}).then(function(token) {
            console.log(token)
            postData('https://www.google.com/recaptcha/api/siteverify', { 
              secret: '6LfgF-kUAAAAAJrYqWwr0Xyl2Zh4bDFQpHVuvFSD',
              response: token
            })
            .then((data) => {
              console.log(data);
              window._res =  data;// JSON data parsed by `response.json()` call
              alert('verification done');
            }).catch((err) => {
              console.log(err);
              alert('verification error');
            });
          });
        });
      });


      // Example POST method implementation:
      async function postData(url = '', data = {}) {
        // Default options are marked with *
        const response = await fetch(url, {
          method: 'POST', // *GET, POST, PUT, DELETE, etc.
          mode: 'no-cors', // no-cors, *cors, same-origin
          headers: {
            'Content-Type': 'application/json'
            // 'Content-Type': 'application/x-www-form-urlencoded',
          },
          redirect: 'follow', // manual, *follow, error
          referrerPolicy: 'no-referrer', // no-referrer, *client
          body: JSON.stringify(data) // body data type must match "Content-Type" header
        });
        return response; // parses JSON response into native JavaScript objects
      }

      
    </script>
  </body>
</html>